# Enable Implicit Function Template Instantiation for Constructors

| Field           | Value                                                           |
|-----------------|-----------------------------------------------------------------|
| DIP:            | 1050                                                            |
| Authors         | Jared Hanson, Dennis Korpel                                     |
| Review Count:   |                                                                 |
| Implementation: | [Dennis Korpel - PR 16910](https://github.com/dlang/dmd/pull/16910)|
| Status:         |                                                                 |

## Abstract

Implicit Function Template Instantiation (IFTI hereafter) and similar mechanisms have been
an unqualified success in both C++ and D, as well as other C-like languages such as Rust,
Java and C#, etc. Removing the need for programmers to explicitly specify types each time
a template function is called vastly improves the ergonomics of the D language as well as
the conciseness, readability, and "DRY factor" of code written in D.

One area where IFTI is _not_ currently done is when calling the constructor for a templated
type.

Ex:
```d
struct Pair(T, U)
{
    T t;
    U u;
   
    this(T t, U u)
    {
        this.t = t;
        this.u = u;
    }
}

Pair!(T, U) pair(T, U)(T t, U u)
{
    return Pair!(T, U)(t, u);
}

void main()
{
    auto p1 = pair(1, "asdf"); // Fine, T and U are inferred as "int" and "string"
    auto p2 = Pair(1, "asdf"); // Error: struct `Pair` is not callable using argument types `!()(int, string)`
                               //       Candidate is: `Pair(T, U)`
}
```

This DIP proposes that IFTI be enabled for constructors as well, just like for regular functions.

### Links

#### Github issue
- [Constructors of templated types should be callable via IFT](https://github.com/dlang/dmd/issues/18343)

#### From the Spec
- [Section 22.6.1 "Implicit Function Template Instantiation (IFTI)"](https://dlang.org/spec/template.html#ifti)

#### Forum Discussion
- [From September 30th 2025, "What was so crazy about IFTI for parent agregate via ctor call ?"](https://forum.dlang.org/post/dlaomdfxdzhxtpbsoixl@forum.dlang.org)

#### Prior Art from Other Languages
- [C++, "Class template argument deduction (CTAD)"](https://en.cppreference.com/w/cpp/language/class_template_argument_deduction)
- [Rust, "Generic Data Types"](https://doc.rust-lang.org/book/ch10-01-syntax.html) (Note that implicit instantiation of both function and struct templates is demonstrated, but not explicitly discussed)
- [Rust, "Functions"](https://doc.rust-lang.org/rust-by-example/generics/gen_fn.html) (ditto)
- [C#, "Generic methods"](https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/generics/generic-methods)
- [Java, "Generic Methods"](https://docs.oracle.com/javase/tutorial/java/generics/methods.html)

## Description

The proposed changes to D are as follows:

When a constructor call is encountered, the compiler checks to see if its containing aggregate is inside a template. If so, it takes the un-instantiated constructor declaration(s) and runs the IFTI algorithm on them to find a match.

### Rationale

IFTI for constructors is a feature that the D community has requested for years. In addition, there is a very tangible benefit that this feature will provide: no need for "trampoline" functions just to make use of IFTI.

<Provide an example below using the trampoline function `std.typecons.tuple`>.

<Add stats on how many trampoline functions exist in Phobos?>

This change should essentially eliminate the need for such functions, reducing the number of template instantiations by the compiler, reducing object file
size, and ultimately reducing binary file size. The net result is faster compilation and smaller file sizes - 3 wins for the _very_ low price of 165 lines of D code (see attached PR).

### Breaking changes / deprecation process

As IFTI is currently not implemented for constructors in D, this will not introduce any breaking changes. 

#### Examples of How Code Will Change with This Proposal

<Not sure if I will include this section yet>

## Copyright & License

Copyright (c) 2025 by the D Language Foundation

Licensed under [Creative Commons Zero 1.0](https://creativecommons.org/publicdomain/zero/1.0/legalcode.txt)

### Reviews
